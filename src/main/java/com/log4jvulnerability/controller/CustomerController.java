package com.log4jvulnerability.controller;

import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestHeader;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

/**
 * @author Dhanushka Paranavithana
 * @since 15/12/2021  16:03
 **/


@RestController
public class CustomerController {

    public static final Logger log = LogManager.getLogger(CustomerController.class);

    /**
     * testing vulnerability issue in log4J
     */
    @GetMapping(value = "/test")
//    @GetMapping(value = "/")
    public String logging(@RequestHeader("X-Api-Version") String apiVersion) {
        log.info("Received a request for API version" + apiVersion);
        return "Hello Dhanushka..!";
    }


    @GetMapping(value = "/test-log")
//    @GetMapping(value = "/")
    public String logging2( @RequestParam("customerName") String customerName) {
        log.info("Received a request for API version" + customerName);
        return "Hello Dhanushka..!";
    }

}
